define ("mod_bigbluebuttonbn/recordings",["exports","core/ajax","core/notification","jquery","mod_bigbluebuttonbn/local/libraries/jquery.dataTable"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;c=f(c);d=f(d);e=f(e);function f(a){return a&&a.__esModule?a:{default:a}}function g(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function h(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function i(a,b,c){if(b)h(a.prototype,b);if(c)h(a,c);return a}function j(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}d.default.fn.dataTable=e.default;var k=function(){function a(b,c,d,e){g(this,a);j(this,"columns",{});j(this,"data",{});j(this,"locale","en");j(this,"windowVideoPlay",null);j(this,"table",null);j(this,"bbbid",0);this.bbbid=b;this.locale=c;this.data=e;this.columns=d;this.datatableInit()}i(a,[{key:"datatableInit",value:function datatableInit(){(0,d.default)("#bigbluebuttonbn_recordings_table").append("<table></table>");this.table=(0,d.default)("#bigbluebuttonbn_recordings_table table").dataTable({columns:this.columns,data:this.data,paginatorLocation:["header","footer"]})}},{key:"filterByText",value:function filterByText(a){if(this.table){this.table.set("data",this.datatable.data);if(a){var b=this.table.data,c=new RegExp("<span>.*?"+this.escapeRegex(a)+".*?</span>","i"),d=b.filter({asList:!0},function(a){var b=a.get("recording"),d=a.get("description");return b&&c.test(b)||d&&c.test(d)});this.table.set("data",d)}}}},{key:"recordingElementPayload",value:function recordingElementPayload(a){var b=(0,d.default)(a),c=b.parent("div");return{action:b.data("action"),recordingid:c.data("recordingid"),meetingid:c.data("meetingid")}}},{key:"recordingAction",value:function recordingAction(a,b,c){var d=this.recordingElementPayload(a);for(var e in c){d[e]=c[e]}if(!b){this.recordingActionPerform(d);return}var f=new M.core.confirm({modal:!0,centered:!0,question:this.recordingConfirmationMessage(d)});f.on("complete-yes",function(){this.recordingActionPerform(d)},this)}},{key:"recordingActionPerform",value:function recordingActionPerform(a){M.mod_bigbluebuttonbn.helpers.toggleSpinningWheelOn(a);M.mod_bigbluebuttonbn.broker.recordingActionPerform(a);var b=this;this.datasource.sendRequest({request:"&id="+this.bbbid+"&action=recording_list_table",callback:{success:function success(a){var c=a.data;if(!1===c.recordings_html&&(-1!=c.profile_features.indexOf("all")||-1!=c.profile_features.indexOf("showrecordings"))){b.locale=c.locale;b.datatable.columns=c.data.columns;b.datatable.data=b.datatableInitFormatDates(c.data.data)}}}})}}]);return a}(),l=function(a){var e=(0,b.call)([{methodname:"mod_bigbluebutton_recording_list_table",args:{bigbluebuttonbnid:Number.parseInt(a.bigbluebuttonbnid)}}]);e[0].done(function(b){var c=b.tabledata;if(!1===c.recordings_html&&(-1!==c.profile_features.indexOf("all")||-1!==c.profile_features.indexOf("showrecordings"))){var f=new k(a.bigbluebuttonbnid,a.locale,c.columns,JSON.parse(c.data));(0,d.default)("#bigbluebuttonbn_recordings_searchform input[type=submit]").click(function(a){a.preventDefault();a.stopPropagation();var b=null;if("searchsubmit"===a.target.get("id")){b=(0,d.default)("#searchtext").get("value")}else{(0,d.default)("#searchtext").set("value","")}f.filterByText(b)})}return c}).catch(c.default.exception)};a.init=l});
//# sourceMappingURL=recordings.min.js.map
